setwd("C:/Users/EG/Desktop/CanD 3/CanD3 Formation/RVM/Exercise 03 oct/Data")
library(readr)
library(tidyverse)
library(broom)
data <- read_csv("gss data.csv")
dta1 |>
distinct(FI_105)
dta1 |>
distinct(FI_105)
dta1 <- data |>
select(PUMFID, FI_105, CSP_100, CSP_110C, TOE_240, TOE_241, UHW_16GR, WORKLW, WORKLYR, REW_10, AGEGR5,SEX, MARSTAT, CHRTIME6, CHRINHDC, AGRNDPAC, FAMTYPE )
dta1 |>
distinct(FI_105)
dta1 <- dta1 |>
mutate(FI_105 = case_when(between(FI_105, 1, 2) ~ "YES",
between(FI_105, 3, 5) ~ "No",
.default = NA),
REW_10 = case_when(REW_10 == 1 ~ "Yes",
REW_10 == 2 ~ "No",
.default = NA),
SEX = case_when(SEX == 1 ~ "Male",
SEX == 2 ~ "Female"),
AGEGR5 = case_when( AGEGR5 == 1 ~ "15-19",
AGEGR5 == 2 ~ "20-24",
AGEGR5 == 3 ~ "25-29",
AGEGR5 == 4 ~ "30-34",
AGEGR5 == 5 ~ "35-39",
AGEGR5 == 6 ~ "40-44",
AGEGR5 == 7 ~ "45-49",
AGEGR5 == 8 ~ "50-54",
between(AGEGR5,9, 14) ~ "55+"),
MARSTAT = case_when(MARSTAT == 1 | MARSTAT == 2 ~ " married/living common",
MARSTAT == 3 ~ "Widowed",
MARSTAT == 4 | MARSTAT == 5 ~ "Separed/divorced",
MARSTAT == 6 ~ "Single",
.default = NA),
CHRINHDC = case_when(CHRINHDC == 0 ~ "No children",
CHRINHDC == 1 ~ "One children",
CHRINHDC == 2 ~ "two children",
between(CHRINHDC, 3, 4) ~ "three +",
.default = NA))  |>
filter(!is.na(FI_105))
table(dta1$FI_105)
model <- glm(FI_105 ~ REW_10 + SEX + MARSTAT+ CHRINHDC+ AGEGR5 ,
data = dta1 |> mutate(FI_105 = if_else(FI_105 == "YES", 1, 0)),
family = binomial(link = "logit"))
summary(model)
model <- glm(FI_105 ~ REW_10 + SEX + MARSTAT+ CHRINHDC+ AGEGR5 ,
data = dta1 |> mutate(FI_105 = if_else(FI_105 == "YES", 1, 0)),
family = binomial(link = "logit")) |> tidy()
summary(model)
print(model)
model <- glm(FI_105 ~ REW_10 + SEX + MARSTAT+ CHRINHDC+ AGEGR5 ,
data = dta1 |> mutate(FI_105 = if_else(FI_105 == "YES", 1, 0)),
family = binomial(link = "logit")) |> tidy(exponentiate = TRUE, conf.int = TRUE)
print(model)
model <- glm(FI_105 ~ REW_10 + SEX + MARSTAT+ CHRINHDC+ AGEGR5 ,
data = dta1 |> mutate(FI_105 = if_else(FI_105 == "YES", 1, 0)),
family = binomial(link = "logit")) |> tidy(exponentiate = TRUE, conf.int = TRUE)
print(model)
print(model)
model <- glm(FI_105 ~ REW_10 + SEX + MARSTAT+ CHRINHDC+ AGEGR5 ,
data = dta1 |> mutate(FI_105 = if_else(FI_105 == "YES", 1, 0)),
family = binomial(link = "logit")) |> tidy(exponentiate = TRUE, conf.int = TRUE) |>
mutate(across(c(estimate, conf.low, conf.high), ~ round(., 3)),
p.value = ifelse(p.value < 0.001, "<0.001", as.character(round(p.value, 3))),
significance = case_when(
p.value == "<0.001" ~ "***",
p.value < 0.01 ~ "**",
p.value < 0.05 ~ "*",
p.value < 0.1 ~ ".",
TRUE ~ ""
)
) |>
select(term, estimate, conf.low, conf.high, p.value, significance)
print(model)
|warning : FALSE
#|warning : FALSE
setwd("C:/Users/EG/Desktop/CanD 3/CanD3 Formation/RVM/Exercise 03 oct/Data")
library(readr)
library(tidyverse)
library(broom)
data <- read_csv("gss data.csv")
setwd("C:/Users/EG/Desktop/CanD 3/CanD3 Formation/RVM/Exercise 03 oct/Data")
library(readr)
library(tidyverse)
library(broom)
data <- read_csv("gss data.csv")
setwd("C:/Users/EG/Desktop/CanD 3/CanD3 Formation/RVM/Exercise 03 oct/Data")
library(readr)
library(tidyverse)
library(broom)
data <- read_csv("gss data.csv")
dta1 <- data |>
select(PUMFID, FI_105, CSP_100, CSP_110C, TOE_240, TOE_241, UHW_16GR, WORKLW, WORKLYR, REW_10, AGEGR5,SEX, MARSTAT, CHRTIME6, CHRINHDC, AGRNDPAC, FAMTYPE )
setwd("C:/Users/EG/Desktop/CanD 3/CanD3 Formation/RVM/Exercise 03 oct/Data")
library(readr)
library(tidyverse)
library(broom)
data <- read_csv("gss data.csv")
dta1 <- data |>
select(PUMFID, FI_105, CSP_100, CSP_110C, TOE_240, TOE_241, UHW_16GR, WORKLW, WORKLYR, REW_10, AGEGR5,SEX, MARSTAT, CHRTIME6, CHRINHDC, AGRNDPAC, FAMTYPE )
library(dplyr)
dta1 |>
distinct(FI_105)
dta1 <- dta1 |>
mutate(FI_105 = case_when(between(FI_105, 1, 2) ~ "YES",
between(FI_105, 3, 5) ~ "No",
.default = NA),
REW_10 = case_when(REW_10 == 1 ~ "Yes",
REW_10 == 2 ~ "No",
.default = NA),
SEX = case_when(SEX == 1 ~ "Male",
SEX == 2 ~ "Female"),
AGEGR5 = case_when( AGEGR5 == 1 ~ "15-19",
AGEGR5 == 2 ~ "20-24",
AGEGR5 == 3 ~ "25-29",
AGEGR5 == 4 ~ "30-34",
AGEGR5 == 5 ~ "35-39",
AGEGR5 == 6 ~ "40-44",
AGEGR5 == 7 ~ "45-49",
AGEGR5 == 8 ~ "50-54",
between(AGEGR5,9, 14) ~ "55+"),
MARSTAT = case_when(MARSTAT == 1 | MARSTAT == 2 ~ " married/living common",
MARSTAT == 3 ~ "Widowed",
MARSTAT == 4 | MARSTAT == 5 ~ "Separed/divorced",
MARSTAT == 6 ~ "Single",
.default = NA),
CHRINHDC = case_when(CHRINHDC == 0 ~ "No children",
CHRINHDC == 1 ~ "One children",
CHRINHDC == 2 ~ "two children",
between(CHRINHDC, 3, 4) ~ "three +",
.default = NA))  |>
filter(!is.na(FI_105))
dta1 |>
select(FI_105, REW_10,SEX, AGEGR5, MARSTAT, CHRINHDC) |>
tbl_summary(
statistic = list(
all_categorial()~ "{n} ({p}%)"
),
digits = list(all_categorial() ~ 1),
label = list(
REW_10 ~ "Revenu, moyenne (ET)",
SEX ~ "Sexe, n (%)",
MARSTAT ~ "Statut marital, n (%)",
CHRINHDC ~ "Maladie chronique, n (%)",
AGEGR5 ~ "Groupe d'âge, n (%)"
) |>
bold_labels() |>
modify_caption("**Tableau 1. Caractéristiques de l'échantillon**")
)
dta1 |>
select(FI_105, REW_10,SEX, AGEGR5, MARSTAT, CHRINHDC) |>
tbl_sum(
statistic = list(
all_categorial()~ "{n} ({p}%)"
),
digits = list(all_categorial() ~ 1),
label = list(
REW_10 ~ "Revenu, moyenne (ET)",
SEX ~ "Sexe, n (%)",
MARSTAT ~ "Statut marital, n (%)",
CHRINHDC ~ "Maladie chronique, n (%)",
AGEGR5 ~ "Groupe d'âge, n (%)"
) |>
bold_labels() |>
modify_caption("**Tableau 1. Caractéristiques de l'échantillon**")
)
library(gtsummary)
install.packages("gtsummary")
setwd("C:/Users/EG/Desktop/CanD 3/CanD3 Formation/RVM/Exercise 03 oct/Data")
#install.packages("gtsummary")
library(readr)
library(tidyverse)
library(broom)
library(dplyr)
library(gtsummary)
data <- read_csv("gss data.csv")
dta1 <- data |>
select(PUMFID, FI_105, CSP_100, CSP_110C, TOE_240, TOE_241, UHW_16GR, WORKLW, WORKLYR, REW_10, AGEGR5,SEX, MARSTAT, CHRTIME6, CHRINHDC, AGRNDPAC, FAMTYPE )
#Recodages des variables
```{r}
dta1 |>
distinct(FI_105)
dta1 <- dta1 |>
mutate(FI_105 = case_when(between(FI_105, 1, 2) ~ "YES",
between(FI_105, 3, 5) ~ "No",
.default = NA),
REW_10 = case_when(REW_10 == 1 ~ "Yes",
REW_10 == 2 ~ "No",
.default = NA),
SEX = case_when(SEX == 1 ~ "Male",
SEX == 2 ~ "Female"),
AGEGR5 = case_when( AGEGR5 == 1 ~ "15-19",
AGEGR5 == 2 ~ "20-24",
AGEGR5 == 3 ~ "25-29",
AGEGR5 == 4 ~ "30-34",
AGEGR5 == 5 ~ "35-39",
AGEGR5 == 6 ~ "40-44",
AGEGR5 == 7 ~ "45-49",
AGEGR5 == 8 ~ "50-54",
between(AGEGR5,9, 14) ~ "55+"),
MARSTAT = case_when(MARSTAT == 1 | MARSTAT == 2 ~ " married/living common",
MARSTAT == 3 ~ "Widowed",
MARSTAT == 4 | MARSTAT == 5 ~ "Separed/divorced",
MARSTAT == 6 ~ "Single",
.default = NA),
CHRINHDC = case_when(CHRINHDC == 0 ~ "No children",
CHRINHDC == 1 ~ "One children",
CHRINHDC == 2 ~ "two children",
between(CHRINHDC, 3, 4) ~ "three +",
.default = NA))  |>
filter(!is.na(FI_105))
dta1 |>
select(FI_105, REW_10,SEX, AGEGR5, MARSTAT, CHRINHDC) |>
tbl_sum(
statistic = list(
all_categorial()~ "{n} ({p}%)"
),
digits = list(all_categorial() ~ 1),
label = list(
REW_10 ~ "Revenu, moyenne (ET)",
SEX ~ "Sexe, n (%)",
MARSTAT ~ "Statut marital, n (%)",
CHRINHDC ~ "Maladie chronique, n (%)",
AGEGR5 ~ "Groupe d'âge, n (%)"
) |>
bold_labels() |>
modify_caption("**Tableau 1. Caractéristiques de l'échantillon**")
)
model <- glm(FI_105 ~ REW_10 + SEX + MARSTAT+ CHRINHDC+ AGEGR5 ,
data = dta1 |> mutate(FI_105 = if_else(FI_105 == "YES", 1, 0)),
family = binomial(link = "logit")) |> gtsummary::tbl_regression(conf.int = TRUE)
setwd("C:/Users/EG/Desktop/CanD 3/CanD3 Formation/RVM/Exercise 03 oct/Data")
#install.packages("gtsummary")
library(readr)
library(tidyverse)
library(broom)
library(dplyr)
library(gtsummary)
data <- read_csv("gss data.csv")
dta1 <- data |>
select(PUMFID, FI_105, CSP_100, CSP_110C, TOE_240, TOE_241, UHW_16GR, WORKLW, WORKLYR, REW_10, AGEGR5,SEX, MARSTAT, CHRTIME6, CHRINHDC, AGRNDPAC, FAMTYPE )
dta1 |>
distinct(FI_105)
dta1 <- dta1 |>
mutate(FI_105 = case_when(between(FI_105, 1, 2) ~ "YES",
between(FI_105, 3, 5) ~ "No",
.default = NA),
REW_10 = case_when(REW_10 == 1 ~ "Yes",
REW_10 == 2 ~ "No",
.default = NA),
SEX = case_when(SEX == 1 ~ "Male",
SEX == 2 ~ "Female"),
AGEGR5 = case_when( AGEGR5 == 1 ~ "15-19",
AGEGR5 == 2 ~ "20-24",
AGEGR5 == 3 ~ "25-29",
AGEGR5 == 4 ~ "30-34",
AGEGR5 == 5 ~ "35-39",
AGEGR5 == 6 ~ "40-44",
AGEGR5 == 7 ~ "45-49",
AGEGR5 == 8 ~ "50-54",
between(AGEGR5,9, 14) ~ "55+"),
MARSTAT = case_when(MARSTAT == 1 | MARSTAT == 2 ~ " married/living common",
MARSTAT == 3 ~ "Widowed",
MARSTAT == 4 | MARSTAT == 5 ~ "Separed/divorced",
MARSTAT == 6 ~ "Single",
.default = NA),
CHRINHDC = case_when(CHRINHDC == 0 ~ "No children",
CHRINHDC == 1 ~ "One children",
CHRINHDC == 2 ~ "two children",
between(CHRINHDC, 3, 4) ~ "three +",
.default = NA))  |>
filter(!is.na(FI_105))
dta1 |>
select(FI_105, REW_10,SEX, AGEGR5, MARSTAT, CHRINHDC) |>
tbl_sum(
statistic = list(
all_categorial()~ "{n} ({p}%)"
),
digits = list(all_categorial() ~ 1),
label = list(
REW_10 ~ "Revenu, moyenne (ET)",
SEX ~ "Sexe, n (%)",
MARSTAT ~ "Statut marital, n (%)",
CHRINHDC ~ "Maladie chronique, n (%)",
AGEGR5 ~ "Groupe d'âge, n (%)"
) |>
bold_labels() |>
modify_caption("**Tableau 1. Caractéristiques de l'échantillon**")
)
model <- glm(FI_105 ~ REW_10 + SEX + MARSTAT+ CHRINHDC+ AGEGR5 ,
data = dta1 |> mutate(FI_105 = if_else(FI_105 == "YES", 1, 0)),
family = binomial(link = "logit")) |> gtsummary::tbl_regression(conf.int = TRUE)
tidy(exponentiate = TRUE, conf.int = TRUE) |>
mutate(across(c(estimate, conf.low, conf.high), ~ round(., 3)),
p.value = ifelse(p.value < 0.001, "<0.001", as.character(round(p.value, 3))),
significance = case_when(
p.value == "<0.001" ~ "***",
p.value < 0.01 ~ "**",
p.value < 0.05 ~ "*",
p.value < 0.1 ~ ".",
TRUE ~ ""
)
) |>
select(term, estimate, conf.low, conf.high, p.value, significance)
model <- glm(FI_105 ~ REW_10 + SEX + MARSTAT+ CHRINHDC+ AGEGR5 ,
data = dta1 |> mutate(FI_105 = if_else(FI_105 == "YES", 1, 0)),
family = binomial(link = "logit")) |> gtsummary::tbl_regression(conf.int = TRUE)
tidy(exponentiate = TRUE, conf.int = TRUE) |>
mutate(across(c(estimate, conf.low, conf.high), ~ round(., 3)),
p.value = ifelse(p.value < 0.001, "<0.001", as.character(round(p.value, 3))),
significance = case_when(
p.value == "<0.001" ~ "***",
p.value < 0.01 ~ "**",
p.value < 0.05 ~ "*",
p.value < 0.1 ~ ".",
TRUE ~ ""
)
) |>
select(term, estimate, conf.low, conf.high, p.value, significance)
model <- glm(FI_105 ~ REW_10 + SEX + MARSTAT+ CHRINHDC+ AGEGR5 ,
data = dta1 |> mutate(FI_105 = if_else(FI_105 == "YES", 1, 0)),
family = binomial(link = "logit")) |> tidy(exponentiate = TRUE, conf.int = TRUE) |>
mutate(across(c(estimate, conf.low, conf.high), ~ round(., 3)),
p.value = ifelse(p.value < 0.001, "<0.001", as.character(round(p.value, 3))),
significance = case_when(
p.value == "<0.001" ~ "***",
p.value < 0.01 ~ "**",
p.value < 0.05 ~ "*",
p.value < 0.1 ~ ".",
TRUE ~ ""
)
) |>
select(term, estimate, conf.low, conf.high, p.value, significance)
print(model)
dta1 |>
select(FI_105, REW_10,SEX, AGEGR5, MARSTAT, CHRINHDC) |>
summarise(across(.cols = where(is.character),
.fns = \(x) names(table(x),
.names = "frequencies_{col}"
)
))
dta1 |>
select(FI_105, REW_10,SEX, AGEGR5, MARSTAT, CHRINHDC) |>
summarise()
dta1 |>
select(FI_105, REW_10,SEX, AGEGR5, MARSTAT, CHRINHDC) |>
summary()
dta1 |>
distinct(FI_105)
dta1 <- dta1 |>
mutate(FI_105 = case_when(between(FI_105, 1, 2) ~ "YES",
between(FI_105, 3, 5) ~ "No",
.default = NA),
REW_10 = case_when(REW_10 == 1 ~ "Yes",
REW_10 == 2 ~ "No",
.default = NA),
SEX = case_when(SEX == 1 ~ "Male",
SEX == 2 ~ "Female"),
AGEGR5 = case_when( AGEGR5 == 1 ~ "15-19",
AGEGR5 == 2 ~ "20-24",
AGEGR5 == 3 ~ "25-29",
AGEGR5 == 4 ~ "30-34",
AGEGR5 == 5 ~ "35-39",
AGEGR5 == 6 ~ "40-44",
AGEGR5 == 7 ~ "45-49",
AGEGR5 == 8 ~ "50-54",
between(AGEGR5,9, 14) ~ "55+"),
MARSTAT = case_when(MARSTAT == 1 | MARSTAT == 2 ~ " married/living common",
MARSTAT == 3 ~ "Widowed",
MARSTAT == 4 | MARSTAT == 5 ~ "Separed/divorced",
MARSTAT == 6 ~ "Single",
.default = NA),
CHRINHDC = case_when(CHRINHDC == 0 ~ "No children",
CHRINHDC == 1 ~ "One children",
CHRINHDC == 2 ~ "two children",
between(CHRINHDC, 3, 4) ~ "three +",
.default = NA))  |>
filter(!is.na(FI_105))
dta1 |>
select(FI_105, REW_10,SEX, AGEGR5, MARSTAT, CHRINHDC) |>
tbl_summary()
model <- glm(FI_105 ~ REW_10 + SEX + MARSTAT+ CHRINHDC+ AGEGR5 ,
data = dta1 |> mutate(FI_105 = if_else(FI_105 == "YES", 1, 0)),
family = binomial(link = "logit")) |> gtsummary::tbl_regression()
print(model)
model <- glm(FI_105 ~ REW_10 + SEX + MARSTAT+ CHRINHDC+ AGEGR5 ,
data = dta1 |> mutate(FI_105 = if_else(FI_105 == "YES", 1, 0)),
family = binomial(link = "logit")) |> gtsummary::tbl_regression()
print(model)
model <- glm(FI_105 ~ REW_10 + SEX + MARSTAT+ CHRINHDC+ AGEGR5 ,
data = dta1 |> mutate(FI_105 = if_else(FI_105 == "YES", 1, 0)),
family = binomial(link = "logit")) |> gtsummary::tbl_regression(exponentiate = TRUE)
print(model)
setwd("C:/Users/EG/Desktop/CanD 3/CanD3 Formation/RVM/Exercise 03 oct/Data")
```{r, warning=FALSE, message=FALSE}
setwd("C:/Users/EG/Desktop/CanD 3/CanD3 Formation/RVM/Exercise 03 oct/Data")
setwd("C:/Users/EG/Desktop/CanD 3/CanD3 Formation\RVM\Exercise 03 oct Donald/Data")
setwd("C:/Users/EG/Desktop/CanD 3/CanD3 Formation/RVM/Exercise 03 oct Donald/Data")
#install.packages("gtsummary")
library(readr)
library(tidyverse)
library(broom)
library(dplyr)
library(gtsummary)
data <- read_csv("gss data.csv")
dta1 <- data |>
select(PUMFID, FI_105, CSP_100, CSP_110C, TOE_240, TOE_241, UHW_16GR, WORKLW, WORKLYR, REW_10, AGEGR5,SEX, MARSTAT, CHRTIME6, CHRINHDC, AGRNDPAC, FAMTYPE )
write_csv(dta1, file = "dta1.csv")
#install.packages("gtsummary")
library(readr)
library(tidyverse)
library(broom)
library(dplyr)
library(gtsummary)
dta1 <- read_csv("dta1.csv")
setwd("C:/Users/EG/Desktop/CanD 3/CanD3 Formation/RVM/Exercise 03 oct Donald/Data")
#install.packages("gtsummary")
library(readr)
library(tidyverse)
library(broom)
library(dplyr)
library(gtsummary)
dta1 <- read_csv("dta1.csv")
```{r}
dta1 |>
distinct(FI_105)
dta1 <- dta1 |>
mutate(FI_105 = case_when(between(FI_105, 1, 2) ~ "YES",
between(FI_105, 3, 5) ~ "No",
.default = NA),
REW_10 = case_when(REW_10 == 1 ~ "Yes",
REW_10 == 2 ~ "No",
.default = NA),
SEX = case_when(SEX == 1 ~ "Male",
SEX == 2 ~ "Female"),
AGEGR5 = case_when( AGEGR5 == 1 ~ "15-19",
AGEGR5 == 2 ~ "20-24",
AGEGR5 == 3 ~ "25-29",
AGEGR5 == 4 ~ "30-34",
AGEGR5 == 5 ~ "35-39",
AGEGR5 == 6 ~ "40-44",
AGEGR5 == 7 ~ "45-49",
AGEGR5 == 8 ~ "50-54",
between(AGEGR5,9, 14) ~ "55+"),
MARSTAT = case_when(MARSTAT == 1 | MARSTAT == 2 ~ " married/living common",
MARSTAT == 3 ~ "Widowed",
MARSTAT == 4 | MARSTAT == 5 ~ "Separed/divorced",
MARSTAT == 6 ~ "Single",
.default = NA),
CHRINHDC = case_when(CHRINHDC == 0 ~ "No children",
CHRINHDC == 1 ~ "One children",
CHRINHDC == 2 ~ "two children",
between(CHRINHDC, 3, 4) ~ "three +",
.default = NA))  |>
filter(!is.na(FI_105))
dta1 |>
select(FI_105, REW_10,SEX, AGEGR5, MARSTAT, CHRINHDC) |>
tbl_summary()
```{r, message=FALSE}
model <- glm(FI_105 ~ REW_10 + SEX + MARSTAT+ CHRINHDC+ AGEGR5 ,
data = dta1 |> mutate(FI_105 = if_else(FI_105 == "YES", 1, 0)),
family = binomial(link = "logit")) |> gtsummary::tbl_regression(exponentiate = TRUE)
print(model)
